<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<title>~/proggin/tutorials/ncurses/filereader.cc.html</title>
<meta name="Generator" content="Vim/7.2">
<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">
</head>
<body bgcolor="#000000" text="#ffffff"><font face="monospace">
<font color="#00ffff">/*</font><font color="#00ffff">&nbsp;</font><br>
<font color="#00ffff">&nbsp;* Filename: filereader.cc</font><br>
<font color="#00ffff">&nbsp;* Description: In this example, we are gonna work with Panels / Frames</font><br>
<font color="#00ffff">&nbsp;* The idea here, is to make a simple file viewer. (Use ^X (Ctrl-X) to</font><br>
<font color="#00ffff">&nbsp;* quit this program)</font><br>
<font color="#00ffff">&nbsp;* Compile With: g++ -o filereader filereader.cc -lncurses++ -lncurses -lpanel</font><br>
<font color="#00ffff">&nbsp;</font><font color="#00ffff">*/</font><br>
<br>
<font color="#8bcdff">#include </font><font color="#ff40ff">&lt;cursesapp.h&gt;</font><br>
<font color="#8bcdff">#include </font><font color="#ff40ff">&lt;cursesp.h&gt;</font><br>
<font color="#8bcdff">#include </font><font color="#ff40ff">&lt;cursesf.h&gt;</font><br>
<font color="#8bcdff">#include </font><font color="#ff40ff">&lt;cursesm.h&gt;</font><br>
<br>
<font color="#8bcdff">#include </font><font color="#ff40ff">&lt;string&gt;</font><br>
<font color="#8bcdff">#include </font><font color="#ff40ff">&lt;sstream&gt;</font><br>
<font color="#8bcdff">#include </font><font color="#ff40ff">&lt;fstream&gt;</font><br>
<br>
<font color="#ffff00">using</font>&nbsp;std::stringstream;<br>
<font color="#ffff00">using</font>&nbsp;std::string;<br>
<font color="#ffff00">using</font>&nbsp;std::ifstream;<br>
<br>
<font color="#cdff8b">class</font>&nbsp;FileReaderApp : <font color="#ffff00">public</font>&nbsp;NCursesApplication<br>
{<br>
<font color="#ffff00">public</font>:<br>
&nbsp;&nbsp;FileReaderApp() : NCursesApplication(<font color="#ff40ff">FALSE</font>)<br>
&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;contents &lt;&lt; <font color="#ff40ff">&quot;You didn't choose a file to read from.. *sigh*</font><font color="#ffcdcd">\n</font><font color="#ff40ff">&quot;</font>&nbsp;&lt;&lt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ff40ff">&quot;Well.. Just Press ^X (Ctrl-X) to exit this program.&quot;</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;maxcols = Root_Window-&gt;cols() + <font color="#ff40ff">1</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;maxlines = Root_Window-&gt;lines() + <font color="#ff40ff">1</font>;<br>
&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;<font color="#00ffff"><b>void</b></font>&nbsp;handleArgs(<font color="#cdff8b">int</font>&nbsp;argc, <font color="#cdff8b">char</font>&nbsp;*argv[]);<br>
&nbsp;&nbsp;<font color="#cdff8b">int</font>&nbsp;run();<br>
<br>
<font color="#ffff00">private</font>:<br>
&nbsp;&nbsp;stringstream contents;<br>
&nbsp;&nbsp;<font color="#cdff8b">int</font>&nbsp;maxcols;<br>
&nbsp;&nbsp;<font color="#cdff8b">int</font>&nbsp;maxlines;<br>
};<br>
<br>
<font color="#00ffff"><b>void</b></font>&nbsp;FileReaderApp::handleArgs(<font color="#cdff8b">int</font>&nbsp;argc, <font color="#cdff8b">char</font>&nbsp;*argv[])<br>
{<br>
&nbsp;&nbsp;ifstream file;<br>
&nbsp;&nbsp;string line;<br>
<br>
&nbsp;&nbsp;<font color="#ffff00">if</font>(argc == <font color="#ff40ff">1</font>)<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ffff00">return</font>;<br>
<br>
&nbsp;&nbsp;file.open(argv[<font color="#ff40ff">1</font>]);<br>
&nbsp;&nbsp;<font color="#ffff00">if</font>(file.is_open())<br>
&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;contents.str(<font color="#ff40ff">&quot;&quot;</font>);<br>
&nbsp;&nbsp;&nbsp;&nbsp;maxlines = <font color="#ff40ff">0</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;maxcols = Root_Window-&gt;cols() + <font color="#ff40ff">1</font>;<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ffff00">while</font>(!file.eof())<br>
&nbsp;&nbsp;&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;getline(file, line);<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<font color="#ffff00">if</font>(line.length() &gt; maxcols)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;maxcols = line.length();<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;contents &lt;&lt; line &lt;&lt; <font color="#ff40ff">&quot;</font><font color="#ffcdcd">\n</font><font color="#ff40ff">&quot;</font>;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;++maxlines;<br>
&nbsp;&nbsp;&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;&nbsp;&nbsp;file.close();<br>
&nbsp;&nbsp;}<br>
}<br>
<br>
<font color="#cdff8b">int</font>&nbsp;FileReaderApp::run()<br>
{<br>
&nbsp;&nbsp;NCursesPanel scrollPanel(Root_Window-&gt;lines(), Root_Window-&gt;cols(), <font color="#ff40ff">0</font>, <font color="#ff40ff">0</font>);<br>
&nbsp;&nbsp;NCursesFramedPad framePad(scrollPanel, maxlines + <font color="#ff40ff">1</font>, maxcols + <font color="#ff40ff">12</font>);<br>
&nbsp;&nbsp;<font color="#cdff8b">int</font>&nbsp;ch = <font color="#ff40ff">0</font>;<br>
<br>
&nbsp;&nbsp;<font color="#ffff00">while</font>((ch = contents.get()) != <font color="#ff40ff">EOF</font>)<br>
&nbsp;&nbsp;{<br>
&nbsp;&nbsp;&nbsp;&nbsp;framePad.addch(ch);<br>
&nbsp;&nbsp;}<br>
<br>
&nbsp;&nbsp;framePad();<br>
&nbsp;&nbsp;<font color="#ffff00">return</font>&nbsp;<font color="#ff40ff">0</font>;<br>
}<br>
<br>
<font color="#cdff8b">static</font>&nbsp;FileReaderApp readApp;<br>
</font></body>
</html>
